<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <!-- Android WebView CSP fix -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: gap: content:;">
    <title>120+</title>
  </head>

  <body>
    <div id="root"></div>
    <!-- CRITICAL: Initialize demo accounts BEFORE React loads -->
    <script>
      (function() {
        const DEMO_USERS = [
          {
            id: '1',
            email: 'patient@demo.com',
            password: 'demo123',
            name: 'John Smith',
            role: 'patient',
            dateOfBirth: '1952-03-15',
            gender: 'male',
            photoUrl: 'https://images.unsplash.com/photo-1758686253859-8ef7e940096e?w=400',
            onboardingComplete: true,
            createdAt: new Date().toISOString(),
            patientData: { id: 'p001', firstName: 'John', lastName: 'Smith' }
          },
          {
            id: '2',
            email: 'caregiver@demo.com',
            password: 'demo123',
            name: 'Anna Johnson',
            role: 'caregiver',
            dateOfBirth: '1978-07-22',
            gender: 'female',
            onboardingComplete: true,
            createdAt: new Date().toISOString(),
            caregiverData: { id: 'c001', firstName: 'Anna', lastName: 'Johnson' }
          },
          {
            id: '3',
            email: 'doctor@demo.com',
            password: 'demo123',
            name: 'Dr. Rodriguez',
            role: 'doctor',
            dateOfBirth: '1975-11-08',
            gender: 'male',
            onboardingComplete: true,
            createdAt: new Date().toISOString(),
            doctorData: { id: 'd001', firstName: 'Maria', lastName: 'Rodriguez', specialization: 'General Practice' }
          }
        ];

        try {
          const existingUsers = localStorage.getItem('mock_users');
          let users = existingUsers ? JSON.parse(existingUsers) : [];

          // Check if demo accounts exist
          const hasPatient = users.some(u => u.email === 'patient@demo.com');
          const hasCaregiver = users.some(u => u.email === 'caregiver@demo.com');
          const hasDoctor = users.some(u => u.email === 'doctor@demo.com');

          // If any demo account is missing, recreate all
          if (!hasPatient || !hasCaregiver || !hasDoctor) {
            console.log('üîß Creating demo accounts...');
            // Remove old demo accounts
            users = users.filter(u => !u.email.includes('demo.com'));
            // Add new demo accounts
            users.push(...DEMO_USERS);
            localStorage.setItem('mock_users', JSON.stringify(users));
            console.log('‚úÖ Demo accounts created:', DEMO_USERS.map(u => u.email).join(', '));
          } else {
            console.log('‚úÖ Demo accounts already exist');
          }
        } catch (error) {
          console.error('‚ùå Failed to initialize demo accounts:', error);
        }
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
